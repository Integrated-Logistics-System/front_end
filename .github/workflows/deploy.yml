name: ğŸš€ Deploy Frontend on NAS

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: self-hosted
    
    steps:
    - name: ğŸ“¥ Checkout latest code
      uses: actions/checkout@v4

    - name: ğŸ³ Deploy with Docker Compose
      run: |
        echo "ğŸ”„ Stopping existing containers..."
        docker-compose down

        echo "ğŸ—ï¸ Building and starting containers..."
        docker-compose up -d --build

        echo "ğŸ§¹ Cleaning up old images..."
        docker image prune -f

        echo "âœ… Deployment completed!"
        docker-compose ps

    - name: ğŸ‰ Success notification
      if: success()
      run: echo "Frontend deployment successful on NAS!"

    - name: ğŸ’¥ Failure notification  
      if: failure()
      run: echo "Frontend deployment failed!"