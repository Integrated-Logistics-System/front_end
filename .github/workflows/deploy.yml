name: Deploy Frontend

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: self-hosted
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Deploy with Docker Compose
      run: |
        echo "🚀 Deploying frontend..."
        docker compose up -d
        echo "✅ Frontend deployment completed"

    - name: Health Check
      run: |
        echo "🏥 Running health check..."
        sleep 15
        
        # Check if container is running
        if docker ps | grep -q recipe-frontend; then
          echo "✅ Frontend container is running"
          docker ps | grep recipe-frontend
        else
          echo "❌ Frontend container not found"
          docker compose logs
          exit 1
        fi