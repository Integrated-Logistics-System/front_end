<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Display Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .recipe-card {
            background: linear-gradient(135deg, #2d1b69, #1e3a8a);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #374151;
        }
        .recipe-meta {
            display: flex;
            gap: 16px;
            margin: 16px 0;
            flex-wrap: wrap;
        }
        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 14px;
        }
        .ingredients {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
            margin: 16px 0;
        }
        .ingredient {
            padding: 8px;
            background: rgba(34, 197, 94, 0.2);
            border-radius: 6px;
            font-size: 14px;
        }
        .steps {
            margin: 16px 0;
        }
        .step {
            display: flex;
            gap: 12px;
            margin: 12px 0;
            padding: 12px;
            background: rgba(249, 115, 22, 0.2);
            border-radius: 8px;
        }
        .step-number {
            background: #f97316;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
        }
        .nutrition {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }
        .nutrition-item {
            text-align: center;
            padding: 12px;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 8px;
        }
        .nutrition-value {
            font-size: 18px;
            font-weight: bold;
            color: #a855f7;
        }
        .nutrition-label {
            font-size: 12px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Recipe Data Display Test</h1>
    
    <div class="recipe-card" id="recipeCard">
        <h2 id="recipeTitle">ë¡œë”© ì¤‘...</h2>
        
        <div class="recipe-meta" id="recipeMeta">
            <!-- ë©”íƒ€ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
        
        <h3>ğŸ¥• í•„ìš”í•œ ì¬ë£Œ</h3>
        <div class="ingredients" id="ingredients">
            <!-- ì¬ë£Œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
        
        <h3>ğŸ“‹ ì¡°ë¦¬ ë°©ë²•</h3>
        <div class="steps" id="steps">
            <!-- ì¡°ë¦¬ ë‹¨ê³„ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
        
        <h3>ğŸ ì˜ì–‘ ì •ë³´</h3>
        <div class="nutrition" id="nutrition">
            <!-- ì˜ì–‘ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <script>
        // ë°±ì—”ë“œ ë³€í™˜ ë¡œì§ì„ ì‹œë®¬ë ˆì´ì…˜
        function transformElasticsearchRecipe(elasticsearchRecipe) {
            const steps = (elasticsearchRecipe.stepsKo && elasticsearchRecipe.stepsKo.length > 0) 
                          ? elasticsearchRecipe.stepsKo 
                          : (elasticsearchRecipe.steps && elasticsearchRecipe.steps.length > 0)
                          ? elasticsearchRecipe.steps
                          : (elasticsearchRecipe.stepsEn && elasticsearchRecipe.stepsEn.length > 0)
                          ? elasticsearchRecipe.stepsEn
                          : [];
            
            const ingredients = elasticsearchRecipe.ingredientsKo || elasticsearchRecipe.ingredients || [];
            
            // ì¡°ë¦¬ì‹œê°„ ë³€í™˜
            let cookingTime = 'N/A';
            if (elasticsearchRecipe.minutes && elasticsearchRecipe.minutes > 0) {
                cookingTime = `${elasticsearchRecipe.minutes}ë¶„`;
            }
            
            // ì¸ë¶„ ì •ë³´ ë³€í™˜
            let servings = '2-3ì¸ë¶„';
            const ingredientCount = elasticsearchRecipe.nIngredients || ingredients.length;
            const cookingMinutes = elasticsearchRecipe.minutes || 30;
            
            if (ingredientCount >= 8 || cookingMinutes >= 180) {
                servings = '4-6ì¸ë¶„';
            } else if (ingredientCount >= 5 || cookingMinutes >= 60) {
                servings = '3-4ì¸ë¶„';
            }
            
            // ì˜ì–‘ì •ë³´ ìƒì„±
            function estimateCalories(ingredientCount) {
                const baseCalories = 150 + (ingredientCount * 25);
                return `${baseCalories}kcal`;
            }
            
            function estimateProtein(ingredients) {
                const proteinIngredients = ingredients.filter(ing => 
                    ing.includes('ë¼ì§€ê³ ê¸°') || ing.includes('ê³ ê¸°') || ing.includes('ê³„ë€') || 
                    ing.includes('ìƒì„ ') || ing.includes('ë‘ë¶€') || ing.includes('ì½©')
                );
                const protein = Math.max(5, proteinIngredients.length * 8);
                return `${protein}g`;
            }
            
            function estimateCarbs(ingredients) {
                const carbIngredients = ingredients.filter(ing =>
                    ing.includes('ì„¤íƒ•') || ing.includes('ë°¥') || ing.includes('ë©´') || 
                    ing.includes('ë¹µ') || ing.includes('ê°ì') || ing.includes('ê³ êµ¬ë§ˆ')
                );
                const carbs = Math.max(10, carbIngredients.length * 15 + ingredients.length * 3);
                return `${carbs}g`;
            }
            
            function estimateFat(ingredients) {
                const fatIngredients = ingredients.filter(ing =>
                    ing.includes('ê¸°ë¦„') || ing.includes('ë²„í„°') || ing.includes('ì¹˜ì¦ˆ') ||
                    ing.includes('ê²¬ê³¼') || ing.includes('ì•„ë³´ì¹´ë„')
                );
                const fat = Math.max(3, fatIngredients.length * 5 + ingredients.length * 1);
                return `${fat}g`;
            }
            
            const nutritionInfo = {
                calories: estimateCalories(ingredients.length),
                protein: estimateProtein(ingredients),
                carbs: estimateCarbs(ingredients),
                fat: estimateFat(ingredients),
            };
            
            return {
                title: elasticsearchRecipe.nameKo || elasticsearchRecipe.name || 'ë ˆì‹œí”¼',
                cookingTime: cookingTime,
                difficulty: elasticsearchRecipe.difficulty || 'ë³´í†µ',
                servings: servings,
                ingredients: ingredients,
                ingredientCount: elasticsearchRecipe.nIngredients || ingredients.length,
                steps: steps.map((step, index) => ({
                    step: index + 1,
                    instruction: step,
                })),
                nutritionInfo: nutritionInfo,
            };
        }
        
        // ì‹¤ì œ Elasticsearch ë°ì´í„° (ë°©ê¸ˆ ê°€ì ¸ì˜¨ ë°ì´í„°)
        const sampleRecipe = {
            "nameKo": "í¬ë¡íŒŸ nc í’€ë“œí¬í¬",
            "name": "crock pot nc pulled pork",
            "minutes": 510,
            "nIngredients": 13,
            "difficulty": "ì°¨ë³„í™”",
            "ingredientsKo": [
                "ì–‘íŒŒ", "ê°ˆìƒ‰ ì„¤íƒ•", "í›ˆì œ íŒŒí”„ë¦¬ì¹´", "ì†Œê¸ˆ", "ê°ˆì€ í›„ì¶”",
                "ë¼ì§€ê³ ê¸° ì—‰ë©ì´ì‚´", "ì‚¬ì´ë‹¤ ì‹ì´ˆ", "ìš°ìŠ¤í„°ì…” ì†ŒìŠ¤", "ìœ¼ê¹¬ ê³ ì¶§ê°€ë£¨",
                "ì„¤íƒ•", "ë§ˆë¥¸ ê²¨ì", "ë§ˆëŠ˜ ì†Œê¸ˆ", "ì¹´ì˜Œ í˜í¼"
            ],
            "stepsKo": [
                "í¬ë¡íŒŸì— ì–‘íŒŒ ë„£ê¸°", "ê°ˆìƒ‰ ì„¤íƒ• ì„ê¸°", "íŒŒí”„ë¦¬ì¹´", "ì†Œê¸ˆê³¼ í›„ì¶”",
                "ë¡œìŠ¤íŠ¸ ìœ„ì— ë¬¸ì§€ë¥´ê¸°", "í¬ë¡íŒŸì— ë¡œìŠ¤íŠ¸ ë„£ê¸°", "ì‹ì´ˆ ì„ê¸°",
                "ìš°ìŠ¤í„°ì…” ì†ŒìŠ¤", "ê³ ì¶” í”Œë ˆì´í¬", "ì„¤íƒ•", "ë¨¸ìŠ¤íƒ€ë“œ",
                "ë§ˆëŠ˜ ì†Œê¸ˆê³¼ ì¹´ì˜Œí˜í¼ë¥¼ ë„£ê³  ì˜ ì„ê¸°", "ë¡œìŠ¤íŠ¸ ìœ„ì— í˜¼í•©ë¬¼ 1/3 ì •ë„ ë¿Œë¦¬ê¸°",
                "ë‚¨ì€ í˜¼í•©ë¬¼ì„ ë®ì–´ ëƒ‰ì¥ ë³´ê´€í•˜ê¸°", "ë¡œìŠ¤íŠ¸ë¥¼ ì•½ë¶ˆì—ì„œ 8~10ì‹œê°„ ì¡°ë¦¬í•˜ê¸°",
                "ê³ ê¸°ì™€ ì–‘íŒŒ êº¼ë‚´ê¸°", "ì–‘íŒŒ ë²„ë¦¬ê³  ê³ ê¸° ì˜ê²Œ ì°¢ê¸°",
                "í¬ë¡íŒŸì—ì„œ ë‚˜ì˜¨ ìœ¡ì¦™ê³¼ ë‚¨ì€ ì‹ì´ˆ í˜¼í•©ë¬¼ ë„£ê¸°", "ê·¸ëŒ€ë¡œ ë˜ëŠ” ìƒŒë“œìœ„ì¹˜ë¡œ ì œê³µí•˜ê¸°",
                "ê°•ë¶ˆì—ì„œ 4ì‹œê°„"
            ]
        };
        
        // ë³€í™˜ ë° í‘œì‹œ
        const transformedRecipe = transformElasticsearchRecipe(sampleRecipe);
        
        // UI ì—…ë°ì´íŠ¸
        document.getElementById('recipeTitle').textContent = transformedRecipe.title;
        
        // ë©”íƒ€ ì •ë³´ í‘œì‹œ
        const metaContainer = document.getElementById('recipeMeta');
        metaContainer.innerHTML = `
            <div class="meta-item">
                <span>â°</span>
                <span>${transformedRecipe.cookingTime}</span>
            </div>
            <div class="meta-item">
                <span>ğŸ‘¥</span>
                <span>${transformedRecipe.servings}</span>
            </div>
            <div class="meta-item">
                <span>ğŸ”¥</span>
                <span>${transformedRecipe.difficulty}</span>
            </div>
            <div class="meta-item">
                <span>ğŸ¥•</span>
                <span>${transformedRecipe.ingredientCount}ê°œ ì¬ë£Œ</span>
            </div>
        `;
        
        // ì¬ë£Œ í‘œì‹œ
        const ingredientsContainer = document.getElementById('ingredients');
        ingredientsContainer.innerHTML = transformedRecipe.ingredients
            .map(ingredient => `<div class="ingredient">âœ“ ${ingredient}</div>`)
            .join('');
        
        // ì¡°ë¦¬ ë‹¨ê³„ í‘œì‹œ
        const stepsContainer = document.getElementById('steps');
        stepsContainer.innerHTML = transformedRecipe.steps
            .map(step => `
                <div class="step">
                    <div class="step-number">${step.step}</div>
                    <div>${step.instruction}</div>
                </div>
            `).join('');
        
        // ì˜ì–‘ ì •ë³´ í‘œì‹œ
        const nutritionContainer = document.getElementById('nutrition');
        nutritionContainer.innerHTML = `
            <div class="nutrition-item">
                <div class="nutrition-value">${transformedRecipe.nutritionInfo.calories}</div>
                <div class="nutrition-label">ì¹¼ë¡œë¦¬</div>
            </div>
            <div class="nutrition-item">
                <div class="nutrition-value">${transformedRecipe.nutritionInfo.protein}</div>
                <div class="nutrition-label">ë‹¨ë°±ì§ˆ</div>
            </div>
            <div class="nutrition-item">
                <div class="nutrition-value">${transformedRecipe.nutritionInfo.carbs}</div>
                <div class="nutrition-label">íƒ„ìˆ˜í™”ë¬¼</div>
            </div>
            <div class="nutrition-item">
                <div class="nutrition-value">${transformedRecipe.nutritionInfo.fat}</div>
                <div class="nutrition-label">ì§€ë°©</div>
            </div>
        `;
        
        console.log('ğŸ” ë³€í™˜ëœ ë ˆì‹œí”¼ ë°ì´í„°:', transformedRecipe);
    </script>
</body>
</html>